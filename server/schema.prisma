datasource db {
    provider = "postgresql"
    url = env("DB_URL")
}

generator client {
    provider = "prisma-client-js"
}

model User {
    id              String       @id @default(uuid()) @db.Uuid
    username        String       @unique
    passwordHash    String
    allocations     Allocation[]
}

model Allocation {
    id        String  @id @default(uuid()) @db.Uuid
    name      String
    assets    Asset[]
    creator   User    @relation(fields: [creatorId], references: [id], onDelete: Cascade)
    creatorId String  @db.Uuid

    @@unique([creatorId, name])
    @@index([creatorId])
}

model Asset {
    id           String     @id @default(uuid()) @db.Uuid
    ticker       String
    percentage   Int
    allocation   Allocation @relation(fields: [allocationId], references: [id], onDelete: Cascade)
    allocationId String     @db.Uuid

    @@unique([allocationId, ticker])
    @@index([allocationId])
}